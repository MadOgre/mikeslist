!function(){"use strict";angular.module("mikeslist",["ui.router"]).run(["$transitions","$state",function(t,o){t.onError({},function(){o.go("root-state.categories-state")})}]).value("globals",{admin:!1})}();
!function(){"use strict";angular.module("mikeslist").config(["$stateProvider","$locationProvider","$urlRouterProvider",function(t,e,i){i.otherwise("/");var o={name:"root-state",abstract:!0,component:"rootComponent"},n={name:"root-state.categories-state",url:"/",views:{"content-view":"categoriesComponent"},resolve:{categories:["categoriesService",function(t){return t.getAllCategories()}],uncategorized:["categoriesService",function(t){return t.getListingsForCategory("uncategorized")}]}},s={name:"root-state.listings-state",url:"/category/{category}",views:{"content-view":"listingsComponent"},resolve:{category:["categoriesService","$stateParams",function(t,e){return t.getListingsForCategory(e.category)}]}},r={name:"root-state.listing-state",url:"/listing/{listingId}",views:{"content-view":"listingComponent"},resolve:{listing:["listingsService","$stateParams",function(t,e){return t.getListing(e.listingId)}]}},a={name:"root-state.new-listing-state",views:{"content-view":"postListingFormComponent"},resolve:{categories:["categoriesService",function(t){return t.getAllCategories()}]}},g={name:"root-state.edit-listing-state",views:{"content-view":"editListingFormComponent"},resolve:{categories:["categoriesService",function(t){return t.getAllCategories()}]},params:{listing:{}}};t.state(o),t.state(n),t.state(s),t.state(r),t.state(a),t.state(g),e.html5Mode(!0)}])}();
!function(){"use strict";angular.module("mikeslist").component("categoriesComponent",{bindings:{categories:"<",uncategorized:"<"},controller:["$scope","globals",function(o,e){var t=this;t.globals=e,t.broadcastCloseAllOthers=function(e){o.$broadcast("close:forms",e)}}],templateUrl:"js/app/components/categories-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("categoryWidgetComponent",{bindings:{category:"<",onBeginEdit:"&"},controller:["$scope","$state","$timeout","categoriesService","globals",function(e,t,n,o,i){var c=this;c.editing=!1,c.globals=i,c.newValue="",c.$onInit=function(){c.newValue=c.category.name},c.beginEdit=function(){c.onBeginEdit({except:c.category}),c.editing=!0,n(function(){document.getElementById("category-edit-field").focus()})},c.cancelEdit=function(){c.editing=!1,c.newValue=c.category.name},c.submitCategory=function(){o.editCategory(c.category.name,{name:c.newValue||""}).then(function(){c.editing=!1,t.go(t.current,{},{reload:!0})}).catch(function(e){document.getElementById("category-edit-field").focus(),window.alert(e.data.error),console.error(e)})},c.deleteCategory=function(){o.removeCategory(c.category.name).then(function(){t.go(t.current,{},{reload:!0})}).catch(function(e){window.alert(e.data.error),console.error(e)})},e.$on("close:forms",function(e,t){t._id!==c.category._id&&c.cancelEdit()})}],templateUrl:"/js/app/components/category-widget-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("createCategoryWidgetComponent",{bindings:{onBeginEdit:"&"},controller:["$scope","$state","$timeout","categoriesService","globals",function(e,t,n,o,i){var c=this;c.editing=!1,c.categoryName="",c.globals=i,c.beginEdit=function(){c.onBeginEdit({except:"new"}),c.editing=!0,n(function(){document.getElementById("category-create-field").focus()})},c.cancelEdit=function(){c.editing=!1,c.categoryName=""},c.submitCategory=function(){o.createCategory(c.categoryName).then(function(){c.editing=!1,t.go(t.current,{},{reload:!0})}).catch(function(e){window.alert(e.data.error),console.error(e)})},e.$on("close:forms",function(e,t){"new"!==t&&c.cancelEdit()})}],templateUrl:"/js/app/components/create-category-widget-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("editListingFormComponent",{bindings:{categories:"<"},controller:["$scope","$state","$stateParams","$timeout","listingsService",function(t,i,n,e,o){var s=this;s.listing={categories:[]},s.checkboxesState=[],s.$onInit=function(){var t=s.categories.map(function(t){return t._id}),i=s.listing.categories.map(function(t){return t._id});Object.assign(s.listing,n.listing),s.checkboxesState=t.map(function(t){return i.indexOf(t)!==-1&&t})},t.$watch(function(){return s.checkboxesState},function(){s.listing.categories=s.checkboxesState.filter(function(t){return t})},!0),s.submitForm=function(){0===s.listing.categories.length?window.alert("You must pick at least 1 category"):o.editListing(n.listing._id,s.listing).then(function(){i.go("root-state.listing-state",{listingId:s.listing._id},{reload:!0})}).catch(function(t){window.alert("An error has occured while saving listing"),console.error(t),i.go("root-state.listing-state",{listingId:n.listing._id},{reload:!0})})}}],templateUrl:"/js/app/components/post-listing-form-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("footerComponent",{templateUrl:"js/app/components/footer-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("headerComponent",{controller:["globals",function(n){var o=this;o.globals=n,o.toggleAdmin=function(){n.admin=!n.admin}}],templateUrl:"js/app/components/header-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("listingComponent",{bindings:{listing:"<"},controller:["globals","listingsService","$state",function(t,n,i){var e=this;e.globals=t,e.deleteListing=function(){window.confirm("Are you sure you want to permanently delete this listing?")&&n.deleteListing(e.listing._id).then(function(){i.go("root-state.categories-state")})}}],templateUrl:"js/app/components/listing-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("listingsComponent",{bindings:{category:"<"},templateUrl:"js/app/components/listings-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("postListingFormComponent",{bindings:{categories:"<"},controller:["listingsService","$state","$scope",function(t,e,o){var i=this;i.listing={categories:[]},i.checkboxesState=[],o.$watch(function(){return i.checkboxesState},function(){i.listing.categories=i.checkboxesState.filter(function(t){return t})},!0),i.submitForm=function(){0===i.listing.categories.length?window.alert("You must pick at least 1 category"):t.postListing(i.listing).then(function(t){e.go("root-state.listing-state",{listingId:t._id},{reload:!0})}).catch(function(t){window.alert("An error has occured while saving listing"),console.error(t),e.go("root-state.categories-state",{},{reload:!0})})}}],templateUrl:"/js/app/components/post-listing-form-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").component("rootComponent",{templateUrl:"js/app/components/root-component.tpl"})}();
!function(){"use strict";angular.module("mikeslist").service("categoriesService",["$http",function(t){var e=this;e.getAllCategories=function(){return t.get("/api/v1/categories").then(function(t){return t.data.filter(function(t){return"uncategorized"!==t.name})})},e.getListingsForCategory=function(e){return t.get("/api/v1/category/"+e).then(function(t){return t.data})},e.createCategory=function(e){return t.post("/api/v1/category",{name:e}).then(function(t){return t.data})},e.editCategory=function(e,n){return t.put("/api/v1/category/"+e,n).then(function(t){return t.data})},e.removeCategory=function(e){return t.delete("/api/v1/category/"+e).then(function(t){return t.data})}}])}();
!function(){"use strict";angular.module("mikeslist").service("listingsService",["$http",function(t){var n=this;n.getListing=function(n){return t.get("/api/v1/listing/"+n).then(function(t){return t.data})},n.postListing=function(n){return t.post("/api/v1/listing",n).then(function(t){return t.data})},n.editListing=function(n,i){return t.put("/api/v1/listing/"+n,i).then(function(t){return t.data})},n.deleteListing=function(n){return t.delete("/api/v1/listing/"+n).then(function(t){return t.data})}}])}();
//# sourceMappingURL=main.js.map
