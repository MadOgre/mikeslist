{"version":3,"sources":["app.js","states.js","services/categories-service.js","services/listings-service.js","components/categories-component.js","components/category-widget-component.js","components/create-category-widget-component.js","components/footer-component.js","components/header-component.js","components/listing-component.js","components/listings-component.js","components/post-listing-form-component.js","components/root-component.js"],"names":["angular","module","run","$transitions","$state","onError","go","value","admin","config","$stateProvider","$locationProvider","$urlRouterProvider","otherwise","rootState","name","abstract","component","categoriesState","url","views","content-view","resolve","categories","categoriesService","getAllCategories","listingsState","listings","$stateParams","getListingsForCategory","category","listingState","listing","listingsService","getListing","listingId","newListingState","state","html5Mode","service","$http","vm","this","get","then","data","filter","createNewCategory","post","editCategory","put","postListing","bindings","controller","$scope","globals","uncategorizedListingsCount","broadcastCloseAllOthers","except","$broadcast","length","catch","err","console","log","templateUrl","onBeginEdit","$timeout","editing","newValue","$onInit","beginEdit","document","getElementById","focus","cancelEdit","submitCategory","current","reload","window","alert","error","$on","event","_id","categoryName","toggleAdmin","checkboxesState","$watch","categoryId","submitForm"],"mappings":"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","file":"main.js","sourcesContent":["(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\", [\"ui.router\"]).\n\trun([\"$transitions\", \"$state\", function($transitions, $state){\n\t\t$transitions.onError({}, function(){\n\t\t\t$state.go(\"root-state.categories-state\");\n\t\t});\n\t}]).\n\tvalue(\"globals\", {\n\t\tadmin: false\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tconfig([\"$stateProvider\", \"$locationProvider\", \"$urlRouterProvider\",\n\t\tfunction($stateProvider, $locationProvider, $urlRouterProvider){\n\t\t\t$urlRouterProvider.otherwise(\"/\");\n\t\t\tvar rootState = {\n\t\t\t\tname: \"root-state\",\n\t\t\t\tabstract: true,\n\t\t\t\tcomponent: \"rootComponent\"\n\t\t\t};\n\t\t\tvar categoriesState = {\n\t\t\t\tname: \"root-state.categories-state\",\n\t\t\t\turl: \"/\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"categoriesComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcategories: [\"categoriesService\", function(categoriesService){\n\t\t\t\t\t\treturn categoriesService.getAllCategories();\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar listingsState = {\n\t\t\t\tname: \"root-state.listings-state\",\n\t\t\t\turl: \"/category/{category}\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"listingsComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tlistings: [\"categoriesService\", \"$stateParams\", function(categoriesService, $stateParams){\n\t\t\t\t\t\treturn categoriesService.getListingsForCategory($stateParams.category);\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar listingState = {\n\t\t\t\tname: \"root-state.listing-state\",\n\t\t\t\turl: \"/listing/{listingId}\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"listingComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tlisting: [\"listingsService\", \"$stateParams\", function(listingsService, $stateParams){\n\t\t\t\t\t\treturn listingsService.getListing($stateParams.listingId);\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar newListingState = {\n\t\t\t\tname: \"root-state.new-listing-state\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"postListingFormComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcategories: [\"categoriesService\", function(categoriesService){\n\t\t\t\t\t\treturn categoriesService.getAllCategories();\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t};\n\t\t\t$stateProvider.state(rootState);\n\t\t\t$stateProvider.state(categoriesState);\n\t\t\t$stateProvider.state(listingsState);\n\t\t\t$stateProvider.state(listingState);\n\t\t\t$stateProvider.state(newListingState);\n\t\t\t$locationProvider.html5Mode(true);\n\t\t}]);\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tservice(\"categoriesService\", [\"$http\", function($http){\n\t\tvar vm = this;\n\t\tvm.getAllCategories = function() {\n\t\t\treturn $http.get(\"/api/v1/categories\").then(function(data){\n\t\t\t\treturn data.data.filter(function(category){\n\t\t\t\t\treturn category.name !== \"uncategorized\";\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\tvm.getListingsForCategory = function(name) {\n\t\t\treturn $http.get(\"/api/v1/category/\" + name).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.createNewCategory = function(name) {\n\t\t\treturn $http.post(\"/api/v1/category\", {name: name}).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.editCategory = function(name, category) {\n\t\t\treturn $http.put(\"/api/v1/category/\" + name, category).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t}]);\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tservice(\"listingsService\", [\"$http\", function($http){\n\t\tvar vm = this;\n\t\tvm.getListing = function(listingId){\n\t\t\treturn $http.get(\"/api/v1/listing/\" + listingId).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.postListing = function(listing) {\n\t\t\treturn $http.post(\"/api/v1/listing\", listing).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t}]);\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"categoriesComponent\", {\n\t\tbindings: {\n\t\t\tcategories: \"<\"\n\t\t},\n\t\tcontroller: [\"$scope\", \"globals\", \"categoriesService\", function($scope, globals, categoriesService){\n\t\t\tvar vm = this;\n\n\t\t\tvm.globals = globals;\n\n\t\t\tvm.uncategorizedListingsCount = 0;\n\n\t\t\t//this function dispatches the event to signal close to all widgets except\n\t\t\t//the one identified by the \"except parameter\"\n\t\t\t//the function is passed as behavior binding (&) to all form widgets\n\t\t\tvm.broadcastCloseAllOthers = function(except){\n\t\t\t\t$scope.$broadcast(\"close:forms\", except);\n\t\t\t};\n\n\t\t\tcategoriesService.getListingsForCategory(\"uncategorized\").\n\t\t\tthen(function(data){\n\t\t\t\tvm.uncategorizedListingsCount = data.length;\n\t\t\t}).\n\t\t\tcatch(function(err){\n\t\t\t\tconsole.log(err);\n\t\t\t});\n\t\t}],\n\t\ttemplateUrl: \"js/app/components/categories-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"categoryWidgetComponent\", {\n\t\tbindings: {\n\t\t\tcategory: \"<\",\n\t\t\tonBeginEdit: \"&\"\n\t\t},\n\t\tcontroller: [\"$scope\", \"$state\", \"$timeout\", \"categoriesService\", \"globals\", function($scope, $state, $timeout, categoriesService, globals) {\n\t\t\tvar vm = this;\n\n\t\t\t//flag indicating the current widget state\n\t\t\tvm.editing = false;\n\n\t\t\t//enables the template to check whether in admin mode or not\n\t\t\tvm.globals = globals;\n\n\t\t\t//placeholder for new category name\n\t\t\tvm.newValue = \"\";\n\n\t\t\t//when category is bound set the new value to same name as category\n\t\t\tvm.$onInit = function() {\n\t\t\t\tvm.newValue = vm.category.name;\n\t\t\t};\n\n\t\t\tvm.beginEdit = function() {\n\n\t\t\t\t//send a signal to parent to dispatch a closing event to all widgets except the current one\n\t\t\t\tvm.onBeginEdit({except: vm.category});\n\t\t\t\tvm.editing = true;\n\n\t\t\t\t//focus the input field\n\t\t\t\t$timeout(function(){\n\t\t\t\t\tdocument.getElementById(\"category-edit-field\").focus();\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvm.cancelEdit = function() {\n\t\t\t\tvm.editing = false;\n\t\t\t\tvm.newValue = vm.category.name;\n\t\t\t};\n\n\t\t\tvm.submitCategory = function() {\n\t\t\t\tcategoriesService.editCategory(vm.category.name, {name: vm.newValue || \"\"}).\n\t\t\t\tthen(function(){\n\t\t\t\t\tvm.editing = false;\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\n\t\t\t\t}).\n\t\t\t\tcatch(function(err){\n\t\t\t\t\tdocument.getElementById(\"category-edit-field\").focus();\n\t\t\t\t\twindow.alert(err.data.error);\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t//if closing event received, check to make sure the current widget was not the sender\n\t\t\t$scope.$on(\"close:forms\", function(event, except){\n\t\t\t\tif (except._id !== vm.category._id) {\n\t\t\t\t\tvm.cancelEdit();\n\t\t\t\t}\n\t\t\t});\n\t\t}],\n\t\ttemplateUrl: \"/js/app/components/category-widget-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"createCategoryWidgetComponent\", {\n\t\tbindings: {\n\t\t\tonBeginEdit: \"&\"\n\t\t},\n\t\tcontroller: [\"$scope\", \"$state\", \"$timeout\", \"categoriesService\", \"globals\", function($scope, $state, $timeout, categoriesService, globals) {\n\t\t\tvar vm = this;\n\n\t\t\t//flag indicating the current widget state\n\t\t\tvm.editing = false;\n\t\t\t\n\t\t\t//placeholder for new category name\n\t\t\tvm.categoryName = \"\";\n\n\t\t\t//enables the template to check whether in admin mode or not\n\t\t\tvm.globals = globals;\n\n\t\t\tvm.beginEdit = function() {\n\n\t\t\t\t//send a signal to parent to dispatch a closing event to all widgets except the current one\n\t\t\t\tvm.onBeginEdit({except: \"new\"});\n\t\t\t\tvm.editing = true;\n\n\t\t\t\t//focus the input field\n\t\t\t\t$timeout(function(){\n\t\t\t\t\tdocument.getElementById(\"category-create-field\").focus();\t\t\t\t\t\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvm.cancelEdit = function() {\n\t\t\t\tvm.editing = false;\n\t\t\t\tvm.categoryName = \"\";\n\t\t\t};\n\n\t\t\tvm.submitCategory = function() {\n\t\t\t\tcategoriesService.createNewCategory(vm.categoryName).\n\t\t\t\tthen(function(){\n\t\t\t\t\tvm.editing = false;\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\n\t\t\t\t}).\n\t\t\t\tcatch(function(err){\n\t\t\t\t\twindow.alert(err.data.error);\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t//if closing event received, check to make sure the current widget was not the sender\n\t\t\t$scope.$on(\"close:forms\", function(event, except){\n\t\t\t\tif (except !== \"new\") {\n\t\t\t\t\tvm.cancelEdit();\n\t\t\t\t}\n\t\t\t});\n\t\t}],\n\t\ttemplateUrl: \"/js/app/components/create-category-widget-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"footerComponent\", {\n\t\ttemplateUrl: \"js/app/components/footer-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"headerComponent\", {\n\t\tcontroller: [\"globals\", function(globals){\n\t\t\tvar vm = this;\n\t\t\tvm.globals = globals;\n\t\t\tvm.toggleAdmin = function() {\n\t\t\t\tglobals.admin = !globals.admin;\n\t\t\t};\n\t\t}],\n\t\ttemplateUrl: \"js/app/components/header-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"listingComponent\", {\n\t\tbindings: {\n\t\t\tlisting: \"<\"\n\t\t},\n\t\tcontroller: [\"globals\", function(globals){\n\t\t\tvar vm = this;\n\t\t\tvm.globals = globals;\n\t\t}],\n\t\ttemplateUrl: \"js/app/components/listing-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"listingsComponent\", {\n\t\tbindings: {\n\t\t\tlistings: \"<\"\n\t\t},\n\t\ttemplateUrl: \"js/app/components/listings-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"postListingFormComponent\", {\n\t\tbindings: {\n\t\t\tcategories: \"<\"\n\t\t},\n\t\tcontroller: [\"listingsService\", \"$state\", \"$scope\", function(listingsService, $state, $scope) {\n\t\t\tvar vm = this;\n\n\t\t\t//prepare listing model\n\t\t\tvm.listing = {\n\t\t\t\tcategories: []\n\t\t\t};\n\n\t\t\t//this array reflects the current state of checkboxes\n\t\t\tvm.checkboxesState = [];\n\n\t\t\t//watch the state of checkbox and synchronize with listing model\n\t\t\t//by filtering out null values\n\t\t\t$scope.$watch(function(){\n\t\t\t\treturn vm.checkboxesState;\n\t\t\t},function(){\n\t\t\t\tvm.listing.categories = vm.checkboxesState.filter(function(categoryId){\n\t\t\t\t\treturn categoryId; //nulls will be ignored\n\t\t\t\t});\n\t\t\t}, true);\n\n\t\t\t//verify at least one category has been selected and submit the form\n\t\t\tvm.submitForm = function() {\n\t\t\t\tif (vm.listing.categories.length === 0) {\n\t\t\t\t\twindow.alert(\"You must pick at least 1 category\");\n\t\t\t\t} else {\n\t\t\t\t\tlistingsService.postListing(vm.listing).\n\t\t\t\t\tthen(function(data){\n\t\t\t\t\t\t$state.go(\"root-state.listing-state\", {listingId: data._id}, {reload: true});\n\t\t\t\t\t}).\n\t\t\t\t\tcatch(function(err){\n\t\t\t\t\t\twindow.alert(\"An error has occured while saving listing\");\n\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t$state.go(\"root-state.categories-state\", {}, {reload: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}],\n\t\ttemplateUrl: \"/js/app/components/post-listing-form-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"rootComponent\", {\n\t\ttemplateUrl: \"js/app/components/root-component.tpl\"\n\t});\n})();"]}