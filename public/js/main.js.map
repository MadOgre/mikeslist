{"version":3,"sources":["app.js","states.js","components/categories-component.js","components/category-widget-component.js","components/create-category-widget-component.js","components/edit-listing-form-component.js","components/footer-component.js","components/header-component.js","components/listing-component.js","components/listings-component.js","components/post-listing-form-component.js","components/root-component.js","services/categories-service.js","services/listings-service.js"],"names":["angular","module","run","$transitions","$state","onError","go","value","admin","config","$stateProvider","$locationProvider","$urlRouterProvider","otherwise","rootState","name","abstract","component","categoriesState","url","views","content-view","resolve","categories","categoriesService","getAllCategories","uncategorized","getListingsForCategory","listingsState","category","$stateParams","listingState","listing","listingsService","getListing","listingId","newListingState","editListingState","params","state","html5Mode","bindings","controller","$scope","globals","vm","this","broadcastCloseAllOthers","except","$broadcast","templateUrl","onBeginEdit","$timeout","editing","newValue","$onInit","beginEdit","document","getElementById","focus","cancelEdit","submitCategory","editCategory","then","current","reload","catch","err","window","alert","data","error","console","deleteCategory","removeCategory","$on","event","_id","categoryName","createCategory","checkboxesState","allCategoryIds","map","currentCategoryIds","Object","assign","categoryId","indexOf","$watch","filter","submitForm","length","editListing","toggleAdmin","deleteListing","confirm","postListing","service","$http","get","post","put","delete"],"mappings":"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","file":"main.js","sourcesContent":["(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\", [\"ui.router\"]).\n\trun([\"$transitions\", \"$state\", function($transitions, $state){\n\t\t$transitions.onError({}, function(){\n\t\t\t$state.go(\"root-state.categories-state\");\n\t\t});\n\t}]).\n\tvalue(\"globals\", {\n\t\tadmin: false\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tconfig([\"$stateProvider\", \"$locationProvider\", \"$urlRouterProvider\",\n\t\tfunction($stateProvider, $locationProvider, $urlRouterProvider){\n\t\t\t$urlRouterProvider.otherwise(\"/\");\n\t\t\tvar rootState = {\n\t\t\t\tname: \"root-state\",\n\t\t\t\tabstract: true,\n\t\t\t\tcomponent: \"rootComponent\"\n\t\t\t};\n\t\t\tvar categoriesState = {\n\t\t\t\tname: \"root-state.categories-state\",\n\t\t\t\turl: \"/\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"categoriesComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcategories: [\"categoriesService\", function(categoriesService){\n\t\t\t\t\t\treturn categoriesService.getAllCategories();\n\t\t\t\t\t}],\n\t\t\t\t\tuncategorized: [\"categoriesService\", function(categoriesService){\n\t\t\t\t\t\treturn categoriesService.getListingsForCategory(\"uncategorized\");\n\t\t\t\t\t}],\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar listingsState = {\n\t\t\t\tname: \"root-state.listings-state\",\n\t\t\t\turl: \"/category/{category}\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"listingsComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcategory: [\"categoriesService\", \"$stateParams\", function(categoriesService, $stateParams){\n\t\t\t\t\t\treturn categoriesService.getListingsForCategory($stateParams.category);\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar listingState = {\n\t\t\t\tname: \"root-state.listing-state\",\n\t\t\t\turl: \"/listing/{listingId}\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"listingComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tlisting: [\"listingsService\", \"$stateParams\", function(listingsService, $stateParams){\n\t\t\t\t\t\treturn listingsService.getListing($stateParams.listingId);\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar newListingState = {\n\t\t\t\tname: \"root-state.new-listing-state\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"postListingFormComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcategories: [\"categoriesService\", function(categoriesService){\n\t\t\t\t\t\treturn categoriesService.getAllCategories();\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar editListingState = {\n\t\t\t\tname: \"root-state.edit-listing-state\",\n\t\t\t\tviews: {\n\t\t\t\t\t\"content-view\": \"editListingFormComponent\"\n\t\t\t\t},\n\t\t\t\tresolve: {\n\t\t\t\t\tcategories: [\"categoriesService\", function(categoriesService){\n\t\t\t\t\t\treturn categoriesService.getAllCategories();\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\tparams: {\n\t\t\t\t\tlisting: {}\n\t\t\t\t}\n\t\t\t};\n\t\t\t$stateProvider.state(rootState);\n\t\t\t$stateProvider.state(categoriesState);\n\t\t\t$stateProvider.state(listingsState);\n\t\t\t$stateProvider.state(listingState);\n\t\t\t$stateProvider.state(newListingState);\n\t\t\t$stateProvider.state(editListingState);\n\t\t\t$locationProvider.html5Mode(true);\n\t\t}]);\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"categoriesComponent\", {\n\t\tbindings: {\n\t\t\tcategories: \"<\",\n\t\t\tuncategorized: \"<\"\n\t\t},\n\t\tcontroller: [\"$scope\", \"globals\", function($scope, globals){\n\t\t\tvar vm = this;\n\n\t\t\tvm.globals = globals;\n\n\t\t\t//this function dispatches the event to signal close to all widgets except\n\t\t\t//the one identified by the \"except parameter\"\n\t\t\t//the function is passed as behavior binding (&) to all form widgets\n\t\t\tvm.broadcastCloseAllOthers = function(except){\n\t\t\t\t$scope.$broadcast(\"close:forms\", except);\n\t\t\t};\n\t\t}],\n\t\ttemplateUrl: \"js/app/components/categories-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"categoryWidgetComponent\", {\n\t\tbindings: {\n\t\t\tcategory: \"<\",\n\t\t\tonBeginEdit: \"&\"\n\t\t},\n\t\tcontroller: [\"$scope\", \"$state\", \"$timeout\", \"categoriesService\", \"globals\", function($scope, $state, $timeout, categoriesService, globals) {\n\t\t\tvar vm = this;\n\n\t\t\t//flag indicating the current widget state\n\t\t\tvm.editing = false;\n\n\t\t\t//enables the template to check whether in admin mode or not\n\t\t\tvm.globals = globals;\n\n\t\t\t//placeholder for new category name\n\t\t\tvm.newValue = \"\";\n\n\t\t\t//when category is bound set the new value to same name as category\n\t\t\tvm.$onInit = function() {\n\t\t\t\tvm.newValue = vm.category.name;\n\t\t\t};\n\n\t\t\tvm.beginEdit = function() {\n\n\t\t\t\t//send a signal to parent to dispatch a closing event to all widgets except the current one\n\t\t\t\tvm.onBeginEdit({except: vm.category});\n\t\t\t\tvm.editing = true;\n\n\t\t\t\t//focus the input field\n\t\t\t\t$timeout(function(){\n\t\t\t\t\tdocument.getElementById(\"category-edit-field\").focus();\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvm.cancelEdit = function() {\n\n\t\t\t\t//set editing to false and revert the newValue back to\n\t\t\t\t//existing category name\n\t\t\t\tvm.editing = false;\n\t\t\t\tvm.newValue = vm.category.name;\n\t\t\t};\n\n\t\t\tvm.submitCategory = function() {\n\t\t\t\tcategoriesService.editCategory(vm.category.name, {name: vm.newValue || \"\"}).\n\t\t\t\tthen(function(){\n\n\t\t\t\t\t//if successful, set editing flag to false\n\t\t\t\t\t//and reload current state\n\t\t\t\t\tvm.editing = false;\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\n\t\t\t\t}).\n\t\t\t\tcatch(function(err){\n\n\t\t\t\t\t//in case of error remain in editing state, focus the\n\t\t\t\t\t//input field, display error message alert box,\n\t\t\t\t\t//and output error to console\n\t\t\t\t\tdocument.getElementById(\"category-edit-field\").focus();\n\t\t\t\t\twindow.alert(err.data.error);\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvm.deleteCategory = function() {\n\t\t\t\tcategoriesService.removeCategory(vm.category.name).\n\t\t\t\tthen(function() {\n\n\t\t\t\t\t//if deletion successful, reload current state\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\n\t\t\t\t}).\n\t\t\t\tcatch(function(err){\n\n\t\t\t\t\t//in case of error, display message alert box\n\t\t\t\t\t//and output error to console\n\t\t\t\t\twindow.alert(err.data.error);\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t//if closing event received, check to make sure the current widget was not the sender\n\t\t\t$scope.$on(\"close:forms\", function(event, except){\n\t\t\t\tif (except._id !== vm.category._id) {\n\t\t\t\t\tvm.cancelEdit();\n\t\t\t\t}\n\t\t\t});\n\t\t}],\n\t\ttemplateUrl: \"/js/app/components/category-widget-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"createCategoryWidgetComponent\", {\n\t\tbindings: {\n\t\t\tonBeginEdit: \"&\"\n\t\t},\n\t\tcontroller: [\"$scope\", \"$state\", \"$timeout\", \"categoriesService\", \"globals\", function($scope, $state, $timeout, categoriesService, globals) {\n\t\t\tvar vm = this;\n\n\t\t\t//flag indicating the current widget state\n\t\t\tvm.editing = false;\n\t\t\t\n\t\t\t//placeholder for new category name\n\t\t\tvm.categoryName = \"\";\n\n\t\t\t//enables the template to check whether in admin mode or not\n\t\t\tvm.globals = globals;\n\n\t\t\tvm.beginEdit = function() {\n\n\t\t\t\t//send a signal to parent to dispatch a closing event to all widgets except the current one\n\t\t\t\tvm.onBeginEdit({except: \"new\"});\n\t\t\t\tvm.editing = true;\n\n\t\t\t\t//focus the input field\n\t\t\t\t$timeout(function(){\n\t\t\t\t\tdocument.getElementById(\"category-create-field\").focus();\t\t\t\t\t\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tvm.cancelEdit = function() {\n\t\t\t\tvm.editing = false;\n\t\t\t\tvm.categoryName = \"\";\n\t\t\t};\n\n\t\t\tvm.submitCategory = function() {\n\t\t\t\tcategoriesService.createCategory(vm.categoryName).\n\t\t\t\tthen(function(){\n\t\t\t\t\tvm.editing = false;\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\n\t\t\t\t}).\n\t\t\t\tcatch(function(err){\n\t\t\t\t\twindow.alert(err.data.error);\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t//if closing event received, check to make sure the current widget was not the sender\n\t\t\t$scope.$on(\"close:forms\", function(event, except){\n\t\t\t\tif (except !== \"new\") {\n\t\t\t\t\tvm.cancelEdit();\n\t\t\t\t}\n\t\t\t});\n\t\t}],\n\t\ttemplateUrl: \"/js/app/components/create-category-widget-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"editListingFormComponent\", {\n\t\tbindings: {\n\t\t\tcategories: \"<\"\n\t\t},\n\t\tcontroller: [\"$scope\", \"$state\", \"$stateParams\", \"$timeout\", \"listingsService\", function($scope, $state, $stateParams, $timeout, listingsService) {\n\t\t\tvar vm = this;\n\n\t\t\t//prepare listing model\n\t\t\tvm.listing = {\n\t\t\t\tcategories: []\n\t\t\t};\n\n\t\t\t//this array reflects the current state of checkboxes\n\t\t\tvm.checkboxesState = [];\n\n\t\t\tvm.$onInit = function(){\n\t\t\t\tvar allCategoryIds = vm.categories.map(function(category){\n\t\t\t\t\treturn category._id;\n\t\t\t\t});\n\t\t\t\tvar currentCategoryIds = vm.listing.categories.map(function(category){\n\t\t\t\t\treturn category._id;\n\t\t\t\t});\n\t\t\t\tObject.assign(vm.listing, $stateParams.listing);\t\t\t\n\t\t\t\tvm.checkboxesState = allCategoryIds.map(function(categoryId){\n\t\t\t\t\treturn currentCategoryIds.indexOf(categoryId) !== -1 ? categoryId : false;\n\t\t\t\t});\n\t\t\t};\n\n\n\t\t\t//watch the state of checkbox and synchronize with listing model\n\t\t\t//which will be submitted by filtering out null values\n\t\t\t//(as checkboxes are checked and unchecked they leave behind null values)\n\t\t\t$scope.$watch(function(){\n\t\t\t\treturn vm.checkboxesState;\n\t\t\t},function(){\n\t\t\t\tvm.listing.categories = vm.checkboxesState.filter(function(categoryId){\n\t\t\t\t\treturn categoryId; //nulls will be ignored\n\t\t\t\t});\n\t\t\t}, true);\n\n\t\t\t//verify at least one category has been selected and submit the form\n\t\t\tvm.submitForm = function() {\n\t\t\t\tif (vm.listing.categories.length === 0) {\n\t\t\t\t\twindow.alert(\"You must pick at least 1 category\");\n\t\t\t\t} else {\n\n\t\t\t\t\t//attempt to update the listing\n\t\t\t\t\tlistingsService.editListing($stateParams.listing._id, vm.listing).\n\t\t\t\t\tthen(function(){\n\n\t\t\t\t\t\t//if successful - redirect to listing state for the saved listing\n\t\t\t\t\t\t$state.go(\"root-state.listing-state\", {listingId: vm.listing._id}, {reload: true});\n\t\t\t\t\t}).\n\t\t\t\t\tcatch(function(err){\n\n\t\t\t\t\t\t//in case of error, display alert message and output error to console\n\t\t\t\t\t\twindow.alert(\"An error has occured while saving listing\");\n\t\t\t\t\t\tconsole.error(err);\n\n\t\t\t\t\t\t//them redirect to the listing state for the original listing\n\t\t\t\t\t\t$state.go(\"root-state.listing-state\", {listingId: $stateParams.listing._id}, {reload: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}],\n\t\ttemplateUrl: \"/js/app/components/post-listing-form-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"footerComponent\", {\n\t\ttemplateUrl: \"js/app/components/footer-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"headerComponent\", {\n\t\tcontroller: [\"globals\", function(globals){\n\t\t\tvar vm = this;\n\t\t\tvm.globals = globals;\n\t\t\tvm.toggleAdmin = function() {\n\t\t\t\tglobals.admin = !globals.admin;\n\t\t\t};\n\t\t}],\n\t\ttemplateUrl: \"js/app/components/header-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"listingComponent\", {\n\t\tbindings: {\n\t\t\tlisting: \"<\"\n\t\t},\n\t\tcontroller: [\"globals\", \"listingsService\", \"$state\", function(globals, listingsService, $state){\n\t\t\tvar vm = this;\n\t\t\tvm.globals = globals;\n\t\t\tvm.deleteListing = function() {\n\t\t\t\tif (window.confirm(\"Are you sure you want to permanently delete this listing?\")) {\n\t\t\t\t\tlistingsService.deleteListing(vm.listing._id).\n\t\t\t\t\tthen(function(){\n\t\t\t\t\t\t$state.go(\"root-state.categories-state\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}],\n\t\ttemplateUrl: \"js/app/components/listing-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"listingsComponent\", {\n\t\tbindings: {\n\t\t\tcategory: \"<\"\n\t\t},\n\t\ttemplateUrl: \"js/app/components/listings-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"postListingFormComponent\", {\n\t\tbindings: {\n\t\t\tcategories: \"<\"\n\t\t},\n\t\tcontroller: [\"listingsService\", \"$state\", \"$scope\", function(listingsService, $state, $scope) {\n\t\t\tvar vm = this;\n\n\t\t\t//prepare listing model\n\t\t\tvm.listing = {\n\t\t\t\tcategories: []\n\t\t\t};\n\n\t\t\t//this array reflects the current state of checkboxes\n\t\t\tvm.checkboxesState = [];\n\n\t\t\t//watch the state of checkbox and synchronize with listing model\n\t\t\t//by filtering out null values\n\t\t\t$scope.$watch(function(){\n\t\t\t\treturn vm.checkboxesState;\n\t\t\t},function(){\n\t\t\t\tvm.listing.categories = vm.checkboxesState.filter(function(categoryId){\n\t\t\t\t\treturn categoryId; //nulls will be ignored\n\t\t\t\t});\n\t\t\t}, true);\n\n\t\t\t//verify at least one category has been selected and submit the form\n\t\t\tvm.submitForm = function() {\n\t\t\t\tif (vm.listing.categories.length === 0) {\n\t\t\t\t\twindow.alert(\"You must pick at least 1 category\");\n\t\t\t\t} else {\n\n\t\t\t\t\t//attempt to post the listing\n\t\t\t\t\tlistingsService.postListing(vm.listing).\n\t\t\t\t\tthen(function(data){\n\n\t\t\t\t\t\t//if successful, load listing state with the saved state id\n\t\t\t\t\t\t$state.go(\"root-state.listing-state\", {listingId: data._id}, {reload: true});\n\t\t\t\t\t}).\n\t\t\t\t\tcatch(function(err){\n\n\t\t\t\t\t\t//if failed, display alert box with message\n\t\t\t\t\t\t//and output error to console\n\t\t\t\t\t\twindow.alert(\"An error has occured while saving listing\");\n\t\t\t\t\t\tconsole.error(err);\n\n\t\t\t\t\t\t//then reload the categories state\n\t\t\t\t\t\t$state.go(\"root-state.categories-state\", {}, {reload: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}],\n\t\ttemplateUrl: \"/js/app/components/post-listing-form-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tcomponent(\"rootComponent\", {\n\t\ttemplateUrl: \"js/app/components/root-component.tpl\"\n\t});\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tservice(\"categoriesService\", [\"$http\", function($http){\n\t\tvar vm = this;\n\t\tvm.getAllCategories = function() {\n\t\t\treturn $http.get(\"/api/v1/categories\").then(function(data){\n\t\t\t\treturn data.data.filter(function(category){\n\t\t\t\t\treturn category.name !== \"uncategorized\";\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\tvm.getListingsForCategory = function(name) {\n\t\t\treturn $http.get(\"/api/v1/category/\" + name).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.createCategory = function(name) {\n\t\t\treturn $http.post(\"/api/v1/category\", {name: name}).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.editCategory = function(name, category) {\n\t\t\treturn $http.put(\"/api/v1/category/\" + name, category).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.removeCategory = function(name) {\n\t\t\treturn $http.delete(\"/api/v1/category/\" + name).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t}]);\n})();","(function(){\n\t\"use strict\";\n\tangular.module(\"mikeslist\").\n\tservice(\"listingsService\", [\"$http\", function($http){\n\t\tvar vm = this;\n\t\tvm.getListing = function(listingId){\n\t\t\treturn $http.get(\"/api/v1/listing/\" + listingId).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.postListing = function(listing) {\n\t\t\treturn $http.post(\"/api/v1/listing\", listing).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.editListing = function(listingId, listing) {\n\t\t\treturn $http.put(\"/api/v1/listing/\" + listingId, listing).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t\tvm.deleteListing = function(listingId) {\n\t\t\treturn $http.delete(\"/api/v1/listing/\" + listingId).then(function(data){\n\t\t\t\treturn data.data;\n\t\t\t});\n\t\t};\n\t}]);\n})();"]}