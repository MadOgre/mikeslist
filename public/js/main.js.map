{"version":3,"sources":["app.js","states.js","templates.js","services/authentication-service.js","services/categories-service.js","services/listings-service.js","services/token-interceptor.js","services/user-login-service.js","services/users-service.js","components/categories-component.js","components/category-widget-component.js","components/create-category-widget-component.js","components/create-user-form-component.js","components/edit-listing-form-component.js","components/edit-user-form-component.js","components/footer-component.js","components/header-component.js","components/listing-component.js","components/listings-component.js","components/login-logout-widget-component.js","components/post-listing-form-component.js","components/root-component.js","components/user-component.js","components/user-widget-component.js","components/users-component.js"],"names":["angular","module","config","$httpProvider","interceptors","push","run","$transitions","$state","onError","go","authenticationService","check","value","adminEditMode","$stateProvider","$locationProvider","$urlRouterProvider","otherwise","rootState","name","abstract","component","resolve","uncategorized","categoriesService","getListingsForCategory","categoriesState","url","views","content-view","categories","getAllCategories","listingsState","category","$stateParams","listingState","listing","listingsService","getListing","listingId","params","newListingState","editListingState","usersState","users","usersService","getAllUsers","userState","user","getSingleUser","email","newUserState","editUserState","state","html5Mode","$templateCache","put","service","$window","vm","this","bindings","loggedIn","localStorage","token","admin","JSON","parse","$http","get","then","data","filter","createCategory","post","editCategory","removeCategory","delete","postListing","editListing","deleteListing","tokenInterceptor","request","headers","factory","$inject","$q","globals","login","password","result","logout","createUser","updateUser","deleteUser","controller","$scope","broadcastCloseAllOthers","except","$broadcast","templateUrl","onBeginEdit","$timeout","editing","newValue","$onInit","beginEdit","document","getElementById","focus","select","cancelEdit","submitCategory","current","reload","catch","err","window","alert","error","console","deleteCategory","$on","event","_id","categoryName","submitForm","passwordConfirmation","log","checkboxesState","allCategoryIds","map","Object","assign","currentCategoryIds","categoryId","indexOf","$watch","length","authenticationBindings","toggleAdminEditMode","confirm","userLoginService","formOpen","cancelLogin"],"mappings":"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","file":"main.js","sourcesContent":["(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\", [\"ui.router\"]).\r\n\t\r\n\tconfig([\"$httpProvider\", function($httpProvider){\r\n\r\n\t\t//insert an interceptor into all $http calls\r\n\t\t$httpProvider.interceptors.push(\"tokenInterceptor\");\r\n\t}]).\r\n\r\n\trun([\"$transitions\", \"$state\", function($transitions, $state){\r\n\t\t\r\n\t\t//if error in transition, change to the categories state (home page)\r\n\t\t$transitions.onError({}, function(){\r\n\t\t\t$state.go(\"root-state.categories-state\");\r\n\t\t});\r\n\t}]).\r\n\r\n\trun([\"authenticationService\", function(authenticationService){\r\n\r\n\t\t//check if logged in\r\n\t\tauthenticationService.check();\r\n\t}]).\r\n\r\n\tvalue(\"globals\", {\r\n\r\n\t\t//set admin mode to false\r\n\t\tadminEditMode: false\r\n\t});\r\n})();","(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tconfig([\"$stateProvider\", \"$locationProvider\", \"$urlRouterProvider\",\r\n\t\tfunction($stateProvider, $locationProvider, $urlRouterProvider){\r\n\t\t\t$urlRouterProvider.otherwise(\"/\");\r\n\t\t\tvar rootState = {\r\n\t\t\t\tname: \"root-state\",\r\n\t\t\t\tabstract: true,\r\n\t\t\t\tcomponent: \"rootComponent\",\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tuncategorized: [\"categoriesService\", function(categoriesService){\r\n\t\t\t\t\t\treturn categoriesService.getListingsForCategory(\"uncategorized\");\r\n\t\t\t\t\t}],\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar categoriesState = {\r\n\t\t\t\tname: \"root-state.categories-state\",\r\n\t\t\t\turl: \"/\",\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"categoriesComponent\"\r\n\t\t\t\t},\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tcategories: [\"categoriesService\", function(categoriesService){\r\n\t\t\t\t\t\treturn categoriesService.getAllCategories();\r\n\t\t\t\t\t}]\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar listingsState = {\r\n\t\t\t\tname: \"root-state.listings-state\",\r\n\t\t\t\turl: \"/category/{category}\",\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"listingsComponent\"\r\n\t\t\t\t},\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tcategory: [\"categoriesService\", \"$stateParams\", function(categoriesService, $stateParams){\r\n\t\t\t\t\t\treturn categoriesService.getListingsForCategory($stateParams.category);\r\n\t\t\t\t\t}]\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar listingState = {\r\n\t\t\t\tname: \"root-state.listing-state\",\r\n\t\t\t\turl: \"/listing/{listingId}\",\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"listingComponent\"\r\n\t\t\t\t},\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tlisting: [\"listingsService\", \"$stateParams\", function(listingsService, $stateParams){\r\n\t\t\t\t\t\treturn listingsService.getListing($stateParams.listingId);\r\n\t\t\t\t\t}]\r\n\t\t\t\t},\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tcategory: {}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar newListingState = {\r\n\t\t\t\tname: \"root-state.new-listing-state\",\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"postListingFormComponent\"\r\n\t\t\t\t},\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tcategories: [\"categoriesService\", function(categoriesService){\r\n\t\t\t\t\t\treturn categoriesService.getAllCategories();\r\n\t\t\t\t\t}]\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar editListingState = {\r\n\t\t\t\tname: \"root-state.edit-listing-state\",\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"editListingFormComponent\"\r\n\t\t\t\t},\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tcategories: [\"categoriesService\", function(categoriesService){\r\n\t\t\t\t\t\treturn categoriesService.getAllCategories();\r\n\t\t\t\t\t}]\r\n\t\t\t\t},\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tlisting: {}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar usersState = {\r\n\t\t\t\tname: \"root-state.users-state\",\r\n\t\t\t\turl: \"/users\",\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tusers: [\"usersService\", function(usersService){\r\n\t\t\t\t\t\treturn usersService.getAllUsers();\r\n\t\t\t\t\t}]\r\n\t\t\t\t},\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"usersComponent\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar userState = {\r\n\t\t\t\tname: \"root-state.user-state\",\r\n\t\t\t\turl: \"/user/{email}\",\r\n\t\t\t\tresolve: {\r\n\t\t\t\t\tuser: [\"usersService\", \"$stateParams\", function(usersService, $stateParams){\r\n\t\t\t\t\t\treturn usersService.getSingleUser($stateParams.email);\r\n\t\t\t\t\t}]\r\n\t\t\t\t},\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"userComponent\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar newUserState = {\r\n\t\t\t\tname: \"root-state.new-user-state\",\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"createUserFormComponent\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar editUserState = {\r\n\t\t\t\tname: \"root-state.edit-user-state\",\r\n\t\t\t\tviews: {\r\n\t\t\t\t\t\"content-view\": \"editUserFormComponent\"\r\n\t\t\t\t},\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tuser: {}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t$stateProvider.state(rootState);\r\n\t\t\t$stateProvider.state(categoriesState);\r\n\t\t\t$stateProvider.state(listingsState);\r\n\t\t\t$stateProvider.state(listingState);\r\n\t\t\t$stateProvider.state(newListingState);\r\n\t\t\t$stateProvider.state(editListingState);\r\n\t\t\t$stateProvider.state(usersState);\r\n\t\t\t$stateProvider.state(userState);\r\n\t\t\t$stateProvider.state(newUserState);\r\n\t\t\t$stateProvider.state(editUserState);\r\n\t\t\t$locationProvider.html5Mode(true);\r\n\t\t}]);\r\n})();","(function(){angular.module('mikeslist').run(['$templateCache', function($templateCache) {$templateCache.put('categories-component.tpl','<ul>\\n\\n\\t<li ng-repeat=\"category in $ctrl.categories\">\\n\\t\\t<category-widget-component on-begin-edit=\"$ctrl.broadcastCloseAllOthers(except)\" category=\"category\"></category-widget-component>\\n\\t</li>\\n\\n\\t<li ng-if=\"$ctrl.globals.adminEditMode && $ctrl.uncategorized.listingCount > 0\">\\n\\t\\t<a ui-sref=\"root-state.listings-state({category: \\'uncategorized\\'})\">uncategorized ({{$ctrl.uncategorized.listingCount}})</a>\\n\\t</li>\\n\\t\\n\\t<li ng-if=\"$ctrl.globals.adminEditMode\">\\n\\t\\t<create-category-widget-component on-begin-edit=\"$ctrl.broadcastCloseAllOthers(except)\"></create-category-widget-component>\\n\\t</li>\\n</ul>');\r\n$templateCache.put('category-widget-component.tpl','<a href=\"\" ng-if=\"!$ctrl.editing && $ctrl.globals.adminEditMode\" ng-click=\"$ctrl.deleteCategory()\">X</a>\\n\\n<a ng-if=\"!$ctrl.editing\" ui-sref=\"root-state.listings-state({category: $ctrl.category.name})\">{{$ctrl.category.name}} ({{$ctrl.category.listingCount}})</a>\\n\\n<a href=\"\" ng-if=\"!$ctrl.editing && $ctrl.globals.adminEditMode\" ng-click=\"$ctrl.beginEdit()\">Edit</a>\\n\\n<form ng-if=\"$ctrl.editing\" ng-submit=\"$ctrl.submitCategory()\">\\n\\t<input id=\"category-edit-field\" type=\"text\" ng-model=\"$ctrl.newValue\" required>\\n\\t<button type=\"submit\">OK</button>\\n\\t<button type=\"button\" ng-click=\"$ctrl.cancelEdit()\">Cancel</button>\\n</form>');\r\n$templateCache.put('create-category-widget-component.tpl','<a href=\"\" ng-click=\"$ctrl.beginEdit()\" ng-if=\"!$ctrl.editing\">Add Category</a>\\n<form ng-if=\"$ctrl.editing\" ng-submit=\"$ctrl.submitCategory()\">\\n\\t<input id=\"category-create-field\" autofocus type=\"text\" placeholder=\"new category\" ng-model=\"$ctrl.categoryName\" required>\\n\\t<button type=\"submit\">OK</button>\\n\\t<button type=\"button\" ng-click=\"$ctrl.cancelEdit()\">Cancel</button>\\n</form>');\r\n$templateCache.put('footer-component.tpl','<h1>This is the Footer</h1>');\r\n$templateCache.put('header-component.tpl','<h1>This is the Header</h1>\\r\\n<a ui-sref=\"root-state.categories-state\">Go home</a><br>\\r\\n<a ng-if=\"$ctrl.authenticationBindings.loggedIn\" href=\"\" ui-sref=\"root-state.new-listing-state\">Post New Listing</a>\\r\\n<a href=\"\" ng-if=\"$ctrl.authenticationBindings.loggedIn && $ctrl.authenticationBindings.admin && !$ctrl.globals.adminEditMode\" ng-click=\"$ctrl.toggleAdminEditMode()\">Edit Mode Off</a>\\r\\n<a href=\"\" ng-if=\"$ctrl.authenticationBindings.loggedIn && $ctrl.authenticationBindings.admin && $ctrl.globals.adminEditMode\" ng-click=\"$ctrl.toggleAdminEditMode()\">Edit Mode On</a>\\r\\n<login-logout-widget-component></login-logout-widget-component>\\r\\n<a ng-if=\"$ctrl.authenticationBindings.loggedIn && $ctrl.authenticationBindings.admin\" ui-sref=\"root-state.users-state\">Users</a>\\r\\n<a ng-if=\"$ctrl.authenticationBindings.loggedIn && $ctrl.authenticationBindings.admin\" ui-sref=\"root-state.listings-state({category: \\'uncategorized\\'})\">uncategorized ({{$ctrl.uncategorized.listingCount}})</a>');\r\n$templateCache.put('listing-component.tpl','<h2>{{$ctrl.listing.title}}</h2>\\n<p>{{$ctrl.listing.body}}</p>\\n<p>{{$ctrl.listing.posterEmail}}</p>\\n<p>This listing can be found in these categories:</p>\\n<ul>\\n\\t<li ng-repeat=\"category in $ctrl.listing.categories\">\\n\\t\\t<a ui-sref=\"root-state.listings-state({category: category.name})\">{{category.name}}</a>\\n\\t</li>\\n</ul>\\n<a ng-if=\"$ctrl.authenticationBindings.email === $ctrl.listing.posterEmail || $ctrl.authenticationBindings.admin\" href=\"\" ui-sref=\"root-state.edit-listing-state({listing: $ctrl.listing})\">edit me</a>\\n<a ng-if=\"$ctrl.authenticationBindings.email === $ctrl.listing.posterEmail || $ctrl.authenticationBindings.admin\" href=\"\" ng-click=\"$ctrl.deleteListing()\">delete me</a>');\r\n$templateCache.put('listing-form.tpl','<form name=\"postListingForm\" ng-submit=\"$ctrl.submitForm()\">\\n\\t<input ng-model=\"$ctrl.listing.title\"\\n\\t\\t   type=\"text\"\\n\\t\\t   placeholder=\"title\"\\n\\t\\t   required>\\n\\t<br>\\n\\t<textarea ng-model=\"$ctrl.listing.body\"\\n\\t\\t\\t  required></textarea>\\n\\t<br>\\n<!-- \\t<input ng-model=\"$ctrl.listing.posterEmail\"\\n\\t\\t   type=\"email\"\\n\\t\\t   placeholder=\"email@example.com\"\\n\\t\\t   required>\\n\\t<br> -->\\n\\t<label for=\"{{category.name + \\'_checkbox\\'}}\"\\n\\t       ng-repeat-start=\"category in $ctrl.categories\">{{category.name}}</label>\\n\\t<input id=\"{{category.name + \\'_checkbox\\'}}\"\\n\\t       ng-model=\"$ctrl.checkboxesState[$index]\"\\n\\t\\t   ng-repeat-end\\n\\t\\t   ng-true-value=\"\\'{{category._id}}\\'\"\\n\\t\\t   type=\"checkbox\">\\n\\t<br>\\n\\t<button type=\"submit\">Submit Form</button>\\n</form>');\r\n$templateCache.put('listings-component.tpl','<ul>\\n\\t<li ng-repeat=\"listing in $ctrl.category.listings\"><a ui-sref=\"root-state.listing-state({listingId: listing._id, category: $ctrl.category})\">{{listing.title}}</a></li>\\n</ul>\\n<div ng-if=\"$ctrl.category.listingCount === 0\">This category is empty</div>');\r\n$templateCache.put('login-logout-widget-component.tpl','\\r\\n<a href=\"\" ng-if=\"!$ctrl.formOpen && !$ctrl.bindings.loggedIn\" ng-click=\"$ctrl.formOpen = true\">Login</a>\\r\\n<span ng-if=\"$ctrl.bindings.loggedIn\">Logged in as: {{$ctrl.bindings.email}}</span>\\r\\n<a href=\"\" ng-if=\"$ctrl.bindings.loggedIn\" ng-click=\"$ctrl.logout()\">Logout</a>\\r\\n<form ng-if=\"$ctrl.formOpen\" ng-submit=\"$ctrl.login()\">\\r\\n\\t<input type=\"text\" ng-model=\"$ctrl.email\">\\r\\n\\t<input type=\"password\" ng-model=\"$ctrl.password\">\\r\\n\\t<button type=\"submit\">Login</button>\\r\\n\\t<button type=\"button\" ng-click=\"$ctrl.cancelLogin()\">Cancel</button>\\r\\n</form>\\r\\n');\r\n$templateCache.put('root-component.tpl','<header class=\"site-header\"><header-component uncategorized=\"$ctrl.uncategorized\"></header-component></header>\\n<main class=\"site-main\" ui-view=\"content-view\"></main>\\n<footer class=\"site-footer\"><footer-component></footer-component></footer>');\r\n$templateCache.put('user-component.tpl','<h1>{{$ctrl.user.email}}</h1>\\r\\n<p ng-if=\"$ctrl.user.admin\">User is admin</p>\\r\\n<a href=\"\" ui-sref=\"root-state.edit-user-state({user: $ctrl.user})\">Edit me</a>\\r\\n<a href=\"\" ng-click=\"$ctrl.deleteUser()\" ng-if=\"$ctrl.authenticationBindings.email !== $ctrl.user.email\">Delete me</a>');\r\n$templateCache.put('user-form.tpl','<form name=\"postListingForm\" ng-submit=\"$ctrl.submitForm()\">\\r\\n\\t<input id=\"email-field\" ng-model=\"$ctrl.user.email\"\\r\\n\\t\\t   type=\"email\"\\r\\n\\t\\t   placeholder=\"user@example.com\"\\r\\n\\t\\t   required>\\r\\n\\t<br>\\r\\n\\t<label for=\"admin-checkbox\">User is admin: </label>\\r\\n\\t<input type=\"checkbox\" ng-model=\"$ctrl.user.admin\" ng-disabled=\"$ctrl.email && $ctrl.authenticationBindings.email === $ctrl.email\">\\r\\n\\t<br>\\r\\n\\t<input type=\"password\" ng-model=\"$ctrl.user.password\" ng-required=\"!$ctrl.email\" placeholder=\"password\">\\r\\n\\t<br>\\r\\n\\t<input type=\"password\" ng-model=\"$ctrl.user.passwordConfirmation\" ng-required=\"!$ctrl.email\" placeholder=\"confirm password\">\\r\\n\\t<br>\\r\\n\\t<button type=\"submit\">Submit Form</button>\\r\\n</form>');\r\n$templateCache.put('user-widget-component.tpl','<a href=\"\" ng-if=\"!$ctrl.editing && $ctrl.globals.admin\" ng-click=\"$ctrl.deleteUser()\">X</a>\\r\\n\\r\\n<a ng-if=\"!$ctrl.editing\" ui-sref=\"root-state.listings-state({category: $ctrl.category.name})\">{{$ctrl.category.name}} ({{$ctrl.category.listingCount}})</a>\\r\\n\\r\\n<a href=\"\" ng-if=\"!$ctrl.editing && $ctrl.globals.admin\" ng-click=\"$ctrl.beginEdit()\">Edit</a>\\r\\n\\r\\n<form ng-if=\"$ctrl.editing\" ng-submit=\"$ctrl.submitCategory()\">\\r\\n\\t<input id=\"category-edit-field\" type=\"text\" ng-model=\"$ctrl.newValue\" required>\\r\\n\\t<button type=\"submit\">OK</button>\\r\\n\\t<button type=\"button\" ng-click=\"$ctrl.cancelEdit()\">Cancel</button>\\r\\n</form>');\r\n$templateCache.put('users-component.tpl','<ul>\\r\\n\\t<li ng-repeat=\"user in $ctrl.users\">\\r\\n\\t\\t<a ui-sref=\"root-state.user-state({email: user.email})\">{{user.email}}</a>\\r\\n\\t</li>\\r\\n\\t<li>\\r\\n\\t\\t<a href=\"\" ui-sref=\"root-state.new-user-state\">Create new user</a>\\r\\n\\t</li>\\r\\n</ul>');}]);})();","//This service maintains information about loggedIn state\r\n//and checks the browser's local storage for login information\r\n//\r\n//The service does not verify the credentials with the backend\r\n//it assumes user is logged in if the token is present\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tservice(\"authenticationService\", [\"$window\", function($window){\r\n\t\tvar vm = this;\r\n\r\n\t\t//bindings are placed into an object to be bound to the DOM\r\n\t\tvm.bindings = {\r\n\t\t\tloggedIn: false,\r\n\t\t};\r\n\r\n\t\t//this function checks the local storage to see if login information is present\r\n\t\t//if it is, it is written into the bindings above\r\n\t\t//if not the bindings are reset\r\n\t\t//the function is called by the intercepror on page load\r\n\t\tvm.check = function() {\r\n\t\t\tif ($window.localStorage.email && $window.localStorage.token) {\r\n\t\t\t\tvm.bindings.loggedIn = true;\r\n\t\t\t\tvm.bindings.email = $window.localStorage.email;\r\n\t\t\t\tvm.bindings.admin = JSON.parse($window.localStorage.admin);\r\n\t\t\t} else {\r\n\t\t\t\tvm.bindings.loggedIn = false;\r\n\t\t\t\tdelete vm.bindings.email;\r\n\t\t\t}\r\n\t\t};\r\n\t}]);\r\n})();","//This service provides access to the \"categories\" api\r\n//The following functions are exposed:\r\n//\r\n//getAllCategories: gets an array of category objects with _id, name, and listing id array\r\n//listingCount virtual field is also available, the listing contents are NOT populated\r\n//the 'uncategorized' category is deliberately omitted, it can only be retrieved\r\n//using the 'getListingsForCategory' function\r\n//\r\n//getListingsForCategory: gets a single category object by name, includes all of the above\r\n//fields and also populates all listing content\r\n//\r\n//createCategory: creates a category with a given name\r\n//\r\n//editCategory: updates category with a given name by assigning the category object (second parameter)\r\n//\r\n//removeCategory: removes category with a given name, if it contains listings\r\n//the category will be removed from each listing\r\n//all orphaned listings will be added to the 'uncategorized' category\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tservice(\"categoriesService\", [\"$http\", function($http){\r\n\t\tvar vm = this;\r\n\t\tvm.getAllCategories = function() {\r\n\t\t\treturn $http.get(\"/api/v1/categories\").then(function(data){\r\n\t\t\t\treturn data.data.filter(function(category){\r\n\t\t\t\t\treturn category.name !== \"uncategorized\";\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.getListingsForCategory = function(name) {\r\n\t\t\treturn $http.get(\"/api/v1/category/\" + name).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.createCategory = function(name) {\r\n\t\t\treturn $http.post(\"/api/v1/category\", {name: name}).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.editCategory = function(name, category) {\r\n\t\t\treturn $http.put(\"/api/v1/category/\" + name, category).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.removeCategory = function(name) {\r\n\t\t\treturn $http.delete(\"/api/v1/category/\" + name).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t}]);\r\n})();","//This service provides the basic listing CRUD api access\r\n//any updates or deletion of listings will be reflected on the categories\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tservice(\"listingsService\", [\"$http\", function($http){\r\n\t\tvar vm = this;\r\n\t\tvm.getListing = function(listingId){\r\n\t\t\treturn $http.get(\"/api/v1/listing/\" + listingId).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.postListing = function(listing) {\r\n\t\t\treturn $http.post(\"/api/v1/listing\", listing).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.editListing = function(listingId, listing) {\r\n\t\t\treturn $http.put(\"/api/v1/listing/\" + listingId, listing).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.deleteListing = function(listingId) {\r\n\t\t\treturn $http.delete(\"/api/v1/listing/\" + listingId).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t}]);\r\n})();","//This service acts as an interceptor for all $http requests\r\n//It appends a token to every request if the token exists\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tfactory(\"tokenInterceptor\", tokenInterceptor);\r\n\r\n\ttokenInterceptor.$inject = [\"$window\"];\r\n\r\n\tfunction tokenInterceptor($window) {\r\n\t\treturn {\r\n\t\t\trequest: function(config) {\r\n\t\t\t\tif ($window.localStorage.token) {\r\n\t\t\t\t\tconfig.headers[\"x-access-token\"] = $window.localStorage.token;\r\n\t\t\t\t}\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n})();","//This service contacts controls the login/logous functionality\r\n//it exposes two functions\r\n//\r\n//login: this function takes and email and password, contacts the backend,\r\n//and passes along the authentication information\r\n//in case of successful login it sets the user email and token on local storage\r\n//and switches the authentication service status to loggedIn\r\n//\r\n//logout: this function does not contact the backend\r\n//it simply erases the token and email from local storage,\r\n//and sets the loggedIn status to false\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tservice(\"userLoginService\", [\"$http\", \"$window\", \"$q\", \"authenticationService\", \"globals\", function($http, $window, $q, authenticationService, globals){\r\n\t\tvar vm = this;\r\n\t\tvm.login = function(email, password) {\r\n\t\t\treturn $http.post(\"/login\", {email: email, password: password}).then(function(data){\r\n\t\t\t\t$window.localStorage.email = data.data.email;\r\n\t\t\t\t$window.localStorage.admin = data.data.admin;\r\n\t\t\t\t$window.localStorage.token = data.data.token;\r\n\t\t\t\tauthenticationService.bindings.loggedIn = true;\r\n\t\t\t\tauthenticationService.bindings.email = data.data.email;\r\n\t\t\t\tauthenticationService.bindings.admin = data.data.admin;\r\n\t\t\t\treturn $q.resolve({result: \"success\"});\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.logout = function() {\r\n\t\t\tdelete $window.localStorage.token;\r\n\t\t\tdelete $window.localStorage.email;\r\n\t\t\tdelete $window.localStorage.admin;\r\n\t\t\tdelete authenticationService.bindings.email;\r\n\t\t\tdelete authenticationService.bindings.admin;\r\n\t\t\tauthenticationService.bindings.loggedIn = false;\r\n\t\t\tglobals.adminEditMode = false;\r\n\t\t\treturn $q.resolve({result: \"success\"});\r\n\t\t};\r\n\t}]);\r\n})();","(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tservice(\"usersService\", [\"$http\", function($http){\r\n\t\tvar vm = this;\r\n\t\tvm.getAllUsers = function() {\r\n\t\t\treturn $http.get(\"/api/v1/users\").then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.getSingleUser = function(email) {\r\n\t\t\treturn $http.get(\"/api/v1/user/\" + email).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.createUser = function(user) {\r\n\t\t\treturn $http.post(\"/api/v1/user\", user).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.updateUser = function(email, user) {\r\n\t\t\treturn $http.put(\"/api/v1/user/\" + email, user).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t\tvm.deleteUser = function(email) {\r\n\t\t\treturn $http.delete(\"/api/v1/user/\" + email).then(function(data){\r\n\t\t\t\treturn data.data;\r\n\t\t\t});\r\n\t\t};\r\n\t}]);\r\n})();","//This component provides a listing of categories\r\n//The two bindings are resolved using the categoriesService\r\n//categories binding gets an array of category objects\r\n//uncategorized binding gets the 'uncategorized' category object with listings populated\r\n//\r\n//The component renders a category widget for every category\r\n//and one for the 'uncategorized' category if not empty and admin mode is on\r\n//\r\n//Also renders a 'create category' widget if admin mode on\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"categoriesComponent\", {\r\n\t\tbindings: {\r\n\t\t\tcategories: \"<\",\r\n\t\t\tuncategorized: \"<\"\r\n\t\t},\r\n\t\tcontroller: [\"$scope\", \"globals\", function($scope, globals){\r\n\t\t\tvar vm = this;\r\n\r\n\t\t\t//this is bound to detect admin (edit mode) state\r\n\t\t\tvm.globals = globals;\r\n\r\n\t\t\t//this function dispatches the event to signal close to all widgets except\r\n\t\t\t//the one identified by the \"except parameter\"\r\n\t\t\t//the function is passed as behavior binding (&) to all form widgets\r\n\t\t\tvm.broadcastCloseAllOthers = function(except){\r\n\t\t\t\t$scope.$broadcast(\"close:forms\", except);\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"categories-component.tpl\"\r\n\t});\r\n})();","//This component displays a name for the category with the listing count\r\n//as well as (if admin) the delete and edit links\r\n//\r\n//Clicking the edit link opens the edit form and calls onBeginEdit binding\r\n//\r\n//category binding is passed down from categories component as a category object\r\n//without resolving the listings\r\n//\r\n//onBeginEdit received a callback to notify parent to close other edit forms\r\n//when this edit form is open\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"categoryWidgetComponent\", {\r\n\t\tbindings: {\r\n\t\t\tcategory: \"<\",\r\n\t\t\tonBeginEdit: \"&\"\r\n\t\t},\r\n\t\tcontroller: [\"$scope\", \"$state\", \"$timeout\", \"categoriesService\", \"globals\", function($scope, $state, $timeout, categoriesService, globals) {\r\n\t\t\tvar vm = this;\r\n\r\n\t\t\t//flag indicating the current widget state\r\n\t\t\tvm.editing = false;\r\n\r\n\t\t\t//enables the template to check whether in admin mode or not\r\n\t\t\tvm.globals = globals;\r\n\r\n\t\t\t//placeholder for new category name\r\n\t\t\tvm.newValue = \"\";\r\n\r\n\t\t\t//when category is bound set the new value to same name as category\r\n\t\t\tvm.$onInit = function() {\r\n\t\t\t\tvm.newValue = vm.category.name;\r\n\t\t\t};\r\n\r\n\t\t\tvm.beginEdit = function() {\r\n\r\n\t\t\t\t//send a signal to parent to dispatch a closing event to all widgets except the current one\r\n\t\t\t\tvm.onBeginEdit({except: vm.category});\r\n\t\t\t\tvm.editing = true;\r\n\r\n\t\t\t\t//focus the input field\r\n\t\t\t\t$timeout(function(){\r\n\t\t\t\t\tdocument.getElementById(\"category-edit-field\").focus();\r\n\t\t\t\t\tdocument.getElementById(\"category-edit-field\").select();\r\n\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tvm.cancelEdit = function() {\r\n\r\n\t\t\t\t//set editing to false and revert the newValue back to\r\n\t\t\t\t//existing category name\r\n\t\t\t\tvm.editing = false;\r\n\t\t\t\tvm.newValue = vm.category.name;\r\n\t\t\t};\r\n\r\n\t\t\tvm.submitCategory = function() {\r\n\t\t\t\tcategoriesService.editCategory(vm.category.name, {name: vm.newValue || \"\"}).\r\n\t\t\t\tthen(function(){\r\n\r\n\t\t\t\t\t//if successful, set editing flag to false\r\n\t\t\t\t\t//and reload current state\r\n\t\t\t\t\tvm.editing = false;\r\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\r\n\t\t\t\t}).\r\n\t\t\t\tcatch(function(err){\r\n\r\n\t\t\t\t\t//in case of error remain in editing state, focus the\r\n\t\t\t\t\t//input field, display error message alert box,\r\n\t\t\t\t\t//and output error to console\r\n\t\r\n\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\tdocument.getElementById(\"category-edit-field\").focus();\r\n\t\t\t\t\t\tdocument.getElementById(\"category-edit-field\").select();\r\n\t\t\t\t\t});\r\n\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tvm.deleteCategory = function() {\r\n\t\t\t\tcategoriesService.removeCategory(vm.category.name).\r\n\t\t\t\tthen(function() {\r\n\r\n\t\t\t\t\t//if deletion successful, reload current state\r\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\r\n\t\t\t\t}).\r\n\t\t\t\tcatch(function(err){\r\n\r\n\t\t\t\t\t//in case of error, display message alert box\r\n\t\t\t\t\t//and output error to console\r\n\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t//if closing event received, check to make sure the current widget was not the sender\r\n\t\t\t$scope.$on(\"close:forms\", function(event, except){\r\n\t\t\t\tif (except._id !== vm.category._id) {\r\n\t\t\t\t\tvm.cancelEdit();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}],\r\n\t\ttemplateUrl: \"category-widget-component.tpl\"\r\n\t});\r\n})();","//This component shows a \"create category\" link which turns into a form\r\n//when activated\r\n//It attempts to create a new category\r\n//Clicking the link calls the onBeginEdit binding to close all other forms on the page\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"createCategoryWidgetComponent\", {\r\n\t\tbindings: {\r\n\t\t\tonBeginEdit: \"&\"\r\n\t\t},\r\n\t\tcontroller: [\"$scope\", \"$state\", \"$timeout\", \"categoriesService\", \"globals\", function($scope, $state, $timeout, categoriesService, globals) {\r\n\t\t\tvar vm = this;\r\n\r\n\t\t\t//flag indicating the current widget state\r\n\t\t\tvm.editing = false;\r\n\t\t\t\r\n\t\t\t//placeholder for new category name\r\n\t\t\tvm.categoryName = \"\";\r\n\r\n\t\t\t//enables the template to check whether in admin mode or not\r\n\t\t\tvm.globals = globals;\r\n\r\n\t\t\tvm.beginEdit = function() {\r\n\r\n\t\t\t\t//send a signal to parent to dispatch a closing event to all widgets except the current one\r\n\t\t\t\tvm.onBeginEdit({except: \"new\"});\r\n\t\t\t\tvm.editing = true;\r\n\r\n\t\t\t\t//focus the input field\r\n\t\t\t\t$timeout(function(){\r\n\t\t\t\t\tdocument.getElementById(\"category-create-field\").focus();\t\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tvm.cancelEdit = function() {\r\n\t\t\t\tvm.editing = false;\r\n\t\t\t\tvm.categoryName = \"\";\r\n\t\t\t};\r\n\r\n\t\t\tvm.submitCategory = function() {\r\n\t\t\t\tcategoriesService.createCategory(vm.categoryName).\r\n\t\t\t\tthen(function(){\r\n\t\t\t\t\tvm.editing = false;\r\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\r\n\t\t\t\t}).\r\n\t\t\t\tcatch(function(err){\r\n\t\t\t\t\t//focus the input field\r\n\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\tdocument.getElementById(\"category-create-field\").focus();\t\t\t\t\t\r\n\t\t\t\t\t\tdocument.getElementById(\"category-create-field\").select();\t\t\t\t\t\r\n\t\t\t\t\t});\r\n\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t//if closing event received, check to make sure the current widget was not the sender\r\n\t\t\t$scope.$on(\"close:forms\", function(event, except){\r\n\t\t\t\tif (except !== \"new\") {\r\n\t\t\t\t\tvm.cancelEdit();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}],\r\n\t\ttemplateUrl: \"create-category-widget-component.tpl\"\r\n\t});\r\n})();","(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"createUserFormComponent\", {\r\n\t\tcontroller: [\"$state\", \"$timeout\", \"usersService\", function($state, $timeout, usersService){\r\n\t\t\tvar vm = this;\r\n\t\t\tvm.user = {};\r\n\t\t\tvm.submitForm = function() {\r\n\t\t\t\tif (!vm.user.password ||\r\n\t\t\t\t\t!vm.user.passwordConfirmation ||\r\n\t\t\t\t\tvm.user.password !== vm.user.passwordConfirmation) {\r\n\t\t\t\t\twindow.alert(\"Passwords do not match!\");\r\n\t\t\t\t\tvm.user.password = \"\";\r\n\t\t\t\t\tvm.user.passwordConfirmation = \"\";\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tusersService.createUser(vm.user).\r\n\t\t\t\tthen(function(data){\r\n\t\t\t\t\t$state.go(\"root-state.user-state\", {email: data.email}, {reload: true});\r\n\t\t\t\t}).\r\n\t\t\t\tcatch(function(err){\r\n\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\tvm.user.password = \"\";\r\n\t\t\t\t\tvm.user.passwordConfirmation = \"\";\r\n\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\tdocument.getElementById(\"email-field\").focus();\r\n\t\t\t\t\t\tdocument.getElementById(\"email-field\").select();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"user-form.tpl\"\r\n\t});\r\n})();","//This component shows the edit listing form for a specific listing\r\n//the \"categories\" binding received all category names to be displayed as checkboxes\r\n//also it receives \"listing\" through state params to get the current listing data and categories\r\n//\r\n//The template used is common between this and post-listing-form-component\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"editListingFormComponent\", {\r\n\t\tbindings: {\r\n\t\t\tcategories: \"<\"\r\n\t\t},\r\n\t\tcontroller: [\"$scope\", \"$state\", \"$stateParams\", \"$timeout\", \"listingsService\", function($scope, $state, $stateParams, $timeout, listingsService) {\r\n\t\t\tvar vm = this;\r\n\r\n\t\t\t//prepare listing model to be submitted in case of update\r\n\t\t\tvm.listing = {\r\n\t\t\t\tcategories: []\r\n\t\t\t};\r\n\r\n\t\t\t//this array reflects the current state of checkboxes\r\n\t\t\tvm.checkboxesState = [];\r\n\r\n\t\t\tvm.$onInit = function(){\r\n\t\t\t\tvar allCategoryIds = vm.categories.map(function(category){\r\n\t\t\t\t\treturn category._id;\r\n\t\t\t\t});\r\n\t\t\t\tObject.assign(vm.listing, $stateParams.listing);\r\n\t\t\t\tvar currentCategoryIds = vm.listing.categories.map(function(category){\r\n\t\t\t\t\treturn category._id;\r\n\t\t\t\t});\t\t\t\r\n\t\t\t\tvm.checkboxesState = allCategoryIds.map(function(categoryId){\r\n\t\t\t\t\treturn currentCategoryIds.indexOf(categoryId) !== -1 ? categoryId : false;\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\r\n\t\t\t//watch the state of checkbox and synchronize with listing model\r\n\t\t\t//which will be submitted by filtering out null values\r\n\t\t\t//(as checkboxes are checked and unchecked they leave behind null values)\r\n\t\t\t$scope.$watch(function(){\r\n\t\t\t\treturn vm.checkboxesState;\r\n\t\t\t},function(){\r\n\t\t\t\tvm.listing.categories = vm.checkboxesState.filter(function(categoryId){\r\n\t\t\t\t\treturn categoryId; //nulls will be ignored\r\n\t\t\t\t});\r\n\t\t\t}, true);\r\n\r\n\t\t\t//verify at least one category has been selected and submit the form\r\n\t\t\tvm.submitForm = function() {\r\n\t\t\t\tif (vm.listing.categories.length === 0) {\r\n\t\t\t\t\twindow.alert(\"You must pick at least 1 category\");\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t//attempt to update the listing\r\n\t\t\t\t\tlistingsService.editListing($stateParams.listing._id, vm.listing).\r\n\t\t\t\t\tthen(function(){\r\n\r\n\t\t\t\t\t\t//if successful - redirect to listing state for the saved listing\r\n\t\t\t\t\t\t$state.go(\"root-state.listing-state\", {listingId: vm.listing._id}, {reload: true});\r\n\t\t\t\t\t}).\r\n\t\t\t\t\tcatch(function(err){\r\n\r\n\t\t\t\t\t\t//in case of error, display alert message and output error to console\r\n\t\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\t\tconsole.error(err);\r\n\r\n\t\t\t\t\t\t//them redirect to the listing state for the original listing\r\n\t\t\t\t\t\t$state.go(\"root-state.listing-state\", {listingId: $stateParams.listing._id}, {reload: true});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"listing-form.tpl\"\r\n\t});\r\n})();","(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"editUserFormComponent\", {\r\n\t\tcontroller: [\"$state\", \"$timeout\", \"$stateParams\", \"usersService\", \"authenticationService\", function($state, $timeout, $stateParams, usersService, authenticationService){\r\n\t\t\tvar vm = this;\r\n\t\t\tvm.user = {};\r\n\t\t\tvm.email = \"\";\r\n\t\t\tvm.authenticationBindings = authenticationService.bindings;\r\n\t\t\tvm.$onInit = function() {\r\n\t\t\t\tvm.email = $stateParams.user.email;\r\n\t\t\t\tObject.assign(vm.user, $stateParams.user);\r\n\t\t\t};\r\n\t\t\tvm.submitForm = function() {\r\n\t\t\t\tif (vm.user.password &&\r\n\t\t\t\t\tvm.user.passwordConfirmation &&\r\n\t\t\t\t\tvm.user.password !== vm.user.passwordConfirmation) {\r\n\t\t\t\t\twindow.alert(\"Passwords do not match!\");\r\n\t\t\t\t\tdelete vm.user.password;\r\n\t\t\t\t\tdelete vm.user.passwordConfirmation;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tusersService.updateUser(vm.email, vm.user).\r\n\t\t\t\tthen(function(data){\r\n\t\t\t\t\t$state.go(\"root-state.user-state\", {email: data.email}, {reload: true});\r\n\t\t\t\t}).\r\n\t\t\t\tcatch(function(err){\r\n\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\tvm.user.password = \"\";\r\n\t\t\t\t\tvm.user.passwordConfirmation = \"\";\r\n\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\tdocument.getElementById(\"email-field\").focus();\r\n\t\t\t\t\t\tdocument.getElementById(\"email-field\").select();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"user-form.tpl\"\r\n\t});\r\n})();","//This is a simple component which renders the footer of the site\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"footerComponent\", {\r\n\t\ttemplateUrl: \"footer-component.tpl\"\r\n\t});\r\n})();","//This is a component that renders the header of the site\r\n//The header contains an admin mode switch (therefore bound to globals)\r\n//Also it contains the login/logout widget\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"headerComponent\", {\r\n\t\tbindings: {\r\n\t\t\tuncategorized: \"<\"\r\n\t\t},\r\n\t\tcontroller: [\"globals\", \"authenticationService\", function(globals, authenticationService){\r\n\t\t\tvar vm = this;\r\n\t\t\tvm.globals = globals;\r\n\t\t\tvm.authenticationBindings = authenticationService.bindings;\r\n\t\t\tvm.toggleAdminEditMode = function() {\r\n\t\t\t\tglobals.adminEditMode = !globals.adminEditMode;\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"header-component.tpl\"\r\n\t});\r\n})();","//This component renders a single listing\r\n//It receives the listing binding resolved in state transition\r\n//Template contains edit and delete links which show up when admin mode is on\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"listingComponent\", {\r\n\t\tbindings: {\r\n\t\t\tlisting: \"<\"\r\n\t\t},\r\n\t\tcontroller: [\"authenticationService\", \"listingsService\", \"$state\", \"$stateParams\", function(authenticationService, listingsService, $state, $stateParams){\r\n\t\t\tvar vm = this;\r\n\t\t\tvm.authenticationBindings = authenticationService.bindings;\r\n\t\t\tvm.deleteListing = function() {\r\n\t\t\t\tif (window.confirm(\"Are you sure you want to permanently delete this listing?\")) {\r\n\t\t\t\t\tlistingsService.deleteListing(vm.listing._id).\r\n\t\t\t\t\tthen(function(){\r\n\t\t\t\t\t\tif ($stateParams.category.name) {\r\n\t\t\t\t\t\t\t$state.go(\"root-state.listings-state\", {category: $stateParams.category.name}, {reload: true});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$state.go(\"root-state.categories-state\", {}, {reload: true});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).\r\n\t\t\t\t\tcatch(function(err){\r\n\r\n\t\t\t\t\t\t//in case of error, display alert message and output error to console\r\n\t\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\t\tconsole.error(err);\r\n\r\n\t\t\t\t\t\t//them reload current state\r\n\t\t\t\t\t\t$state.go($state.current, {}, {reload: true});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"listing-component.tpl\"\r\n\t});\r\n})();","//This component renders all listing titles for category\r\n//The binding is resolved in state transition\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"listingsComponent\", {\r\n\t\tbindings: {\r\n\t\t\tcategory: \"<\"\r\n\t\t},\r\n\t\ttemplateUrl: \"listings-component.tpl\"\r\n\t});\r\n})();","//This component widget is placed in the header and controls login and logout functionality\r\n//via the userLoginService and authenticationService\r\n//the bindings is an object containing login information and is bound via\r\n//authentication service\r\n//When login link is clicked the form is displayed\r\n//\r\n//The service exposes the following functions\r\n//\r\n//login: sends the login information to the backend via userLoginService\r\n//in case of successful login, cancel login function is called to clear the username and password\r\n//in case of login failure form remains open and username and password is cleared\r\n//\r\n//logout: sends the logout request to userLoginService\r\n//in case of failure the message is displayed (should never fail)\r\n//\r\n//cancelLogin: clears the username and password and closes the login form\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"loginLogoutWidgetComponent\", {\r\n\t\tcontroller: [\"$window\", \"$state\", \"userLoginService\", \"authenticationService\", function($window, $state, userLoginService, authenticationService) {\r\n\t\t\tvar vm = this;\r\n\t\t\tvm.formOpen = false;\r\n\t\t\tvm.bindings = authenticationService.bindings;\r\n\r\n\t\t\tvm.login = function() {\r\n\t\t\t\tuserLoginService.login(vm.email, vm.password).\r\n\t\t\t\tthen(function(){\r\n\t\t\t\t\tvm.cancelLogin();\r\n\t\t\t\t}).\r\n\t\t\t\tcatch(function(err) {\r\n\t\t\t\t\tvm.email = \"\";\r\n\t\t\t\t\tvm.password = \"\";\r\n\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tvm.logout = function() {\r\n\t\t\t\tuserLoginService.logout().\r\n\t\t\t\tthen(function(){\r\n\t\t\t\t\t$state.go($state.current, {}, {reload: true});\r\n\t\t\t\t}).\r\n\t\t\t\tcatch(function(err) {\r\n\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tvm.cancelLogin = function() {\r\n\t\t\t\tvm.email = \"\";\r\n\t\t\t\tvm.password = \"\";\r\n\t\t\t\tvm.formOpen = false;\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"login-logout-widget-component.tpl\"\r\n\t});\r\n})();","//This component shows the post listing form for a specific listing\r\n//the \"categories\" binding received all category names to be displayed as checkboxes\r\n//\r\n//The template used is common between this and post-listing-form-component\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"postListingFormComponent\", {\r\n\t\tbindings: {\r\n\t\t\tcategories: \"<\"\r\n\t\t},\r\n\t\tcontroller: [\"listingsService\", \"$state\", \"$scope\", function(listingsService, $state, $scope) {\r\n\t\t\tvar vm = this;\r\n\r\n\t\t\t//prepare listing model\r\n\t\t\tvm.listing = {\r\n\t\t\t\tcategories: []\r\n\t\t\t};\r\n\r\n\t\t\t//this array reflects the current state of checkboxes\r\n\t\t\tvm.checkboxesState = [];\r\n\r\n\t\t\t//watch the state of checkbox and synchronize with listing model\r\n\t\t\t//by filtering out null values\r\n\t\t\t$scope.$watch(function(){\r\n\t\t\t\treturn vm.checkboxesState;\r\n\t\t\t},function(){\r\n\t\t\t\tvm.listing.categories = vm.checkboxesState.filter(function(categoryId){\r\n\t\t\t\t\treturn categoryId; //nulls will be ignored\r\n\t\t\t\t});\r\n\t\t\t}, true);\r\n\r\n\t\t\t//verify at least one category has been selected and submit the form\r\n\t\t\tvm.submitForm = function() {\r\n\t\t\t\tif (vm.listing.categories.length === 0) {\r\n\t\t\t\t\twindow.alert(\"You must pick at least 1 category\");\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t//attempt to post the listing\r\n\t\t\t\t\tlistingsService.postListing(vm.listing).\r\n\t\t\t\t\tthen(function(data){\r\n\r\n\t\t\t\t\t\t//if successful, load listing state with the saved state id\r\n\t\t\t\t\t\t$state.go(\"root-state.listing-state\", {listingId: data._id}, {reload: true});\r\n\t\t\t\t\t}).\r\n\t\t\t\t\tcatch(function(err){\r\n\r\n\t\t\t\t\t\t//if failed, display alert box with message\r\n\t\t\t\t\t\t//and output error to console\r\n\t\t\t\t\t\twindow.alert(err.data.error);\r\n\t\t\t\t\t\tconsole.error(err);\r\n\r\n\t\t\t\t\t\t//then reload the categories state\r\n\t\t\t\t\t\t$state.go(\"root-state.categories-state\", {}, {reload: true});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"listing-form.tpl\"\r\n\t});\r\n})();","//This is a root component, it simply renders header and components\r\n//and provides a placeholder for current content component\r\n\r\n(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"rootComponent\", {\r\n\t\tbindings: {\r\n\t\t\tuncategorized: \"<\"\r\n\t\t},\r\n\t\ttemplateUrl: \"root-component.tpl\"\r\n\t});\r\n})();","(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"userComponent\", {\r\n\t\tbindings: {\r\n\t\t\tuser: \"<\"\r\n\t\t},\r\n\t\tcontroller: [\"usersService\", \"authenticationService\", \"$state\", function(usersService, authenticationService, $state){\r\n\t\t\tvar vm = this;\r\n\t\t\tvm.authenticationBindings = authenticationService.bindings;\r\n\t\t\tvm.deleteUser = function() {\r\n\t\t\t\tif (window.confirm(\"Are you sure you want to permanently delete this user?\")) {\r\n\t\t\t\t\tusersService.deleteUser(vm.user.email).\r\n\t\t\t\t\tthen(function(){\r\n\t\t\t\t\t\t$state.go(\"root-state.users-state\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}],\r\n\t\ttemplateUrl: \"user-component.tpl\"\r\n\t});\r\n})();","(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"userWidgetComponent\", {\r\n\t\tbindings: {\r\n\t\t\tuser: \"<\"\r\n\t\t},\r\n\t\ttemplateUrl: \"user-widget-component\"\r\n\t});\r\n})();","(function(){\r\n\t\"use strict\";\r\n\tangular.module(\"mikeslist\").\r\n\tcomponent(\"usersComponent\", {\r\n\t\tbindings: {\r\n\t\t\tusers: \"<\"\r\n\t\t},\r\n\t\ttemplateUrl: \"users-component.tpl\"\r\n\t});\r\n})();"]}